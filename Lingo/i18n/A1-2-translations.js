(() => {
  const data = {
    fallbackLanguage: "de",
    languages: {
      de: { label: "Deutsch", dir: "ltr" },
      en: { label: "English", dir: "ltr" },
    },
    translations: {
      de: {
        "page.title": "Unbestimmte Artikel im Singular",
        "intro.title": "Unbestimmte Artikel im Singular",
        "intro.subtitle": "ein oder eine?",
        "intro.description": "Lerne, wie du ein und eine benutzt, um Personen, Dinge und Orte zum ersten Mal zu beschreiben.",
        "intro.level": "Anfänger · A1",
        "intro.duration": "10 Minuten",
        "rule.title": "Grundregel",
        "rule.subtitle": "Zuordnung nach Genus",
        "rule.description": "Der unbestimmte Artikel richtet sich nach dem grammatischen Geschlecht:",
        "rule.item1.left": "Maskulin",
        "rule.item1.right": "ein Mann · ein Stuhl",
        "rule.item2.left": "Feminin",
        "rule.item2.right": "eine Frau · eine Lampe",
        "rule.item3.left": "Neutrum",
        "rule.item3.right": "ein Kind · ein Haus",
        "usage.title": "Wann benutzt du sie?",
        "usage.subtitle": "Typische Situationen",
        "usage.item1.left": "Neue Informationen",
        "usage.item1.right": "Das ist ein Zimmer.",
        "usage.item2.left": "Berufe",
        "usage.item2.right": "Sie ist eine Ärztin.",
        "usage.item3.left": "Zählen",
        "usage.item3.right": "Ich habe ein Ticket.",
        "examples.title": "Beispiele im Kontext",
        "examples.subtitle": "Merke dir ganze Sätze",
        "examples.item1.left": "Das ist ein Lehrer aus Berlin.",
        "examples.item2.left": "Ich suche eine Wohnung in der Stadt.",
        "examples.item3.left": "Wir planen ein Fest für Freunde.",
        "practice.q1.prompt": "Das ist ___ Tisch.",
        "practice.q1.option1": "ein",
        "practice.q1.option2": "eine",
        "practice.q1.option3": "einen",
        "practice.q2.prompt": "Sie kauft ___ Blume.",
        "practice.q2.option1": "ein",
        "practice.q2.option2": "eine",
        "practice.q2.option3": "einer",
        "practice.drag1.prompt": "Ordne die Wörter zu einem Satz.",
        "practice.drag1.word1": "Apfel",
        "practice.drag1.word2": "ist",
        "practice.drag1.word3": "Das",
        "practice.drag1.word4": "ein",
        "practice.q4.prompt": "Wir brauchen ___ Idee.",
        "practice.q4.option1": "eine",
        "practice.q4.option2": "ein",
        "practice.q4.option3": "einem",
        "practice.q5.prompt": "Er schreibt ___ Brief.",
        "practice.q5.option1": "eine",
        "practice.q5.option2": "einen",
        "practice.q5.option3": "ein",
        "practice.q6.prompt": "Ich brauche ___ Glas Wasser.",
        "practice.q6.option1": "ein",
        "practice.q6.option2": "eine",
        "practice.q6.option3": "einem",
        "practice.q7.prompt": "Hast du ___ Frage?",
        "practice.q7.option1": "ein",
        "practice.q7.option2": "eine",
        "practice.q7.option3": "einen",
        "practice.drag2.prompt": "Setze den Satz zusammen.",
        "practice.drag2.word1": "ein",
        "practice.drag2.word2": "haben",
        "practice.drag2.word3": "Problem",
        "practice.drag2.word4": "Wir",
        "practice.q9.prompt": "Das Kind malt ___ Bild.",
        "practice.q9.option1": "eine",
        "practice.q9.option2": "ein",
        "practice.q9.option3": "einem",
        "practice.q10.prompt": "Ich treffe ___ Freundin im Café.",
        "practice.q10.option1": "ein",
        "practice.q10.option2": "eine",
        "practice.q10.option3": "einer",
        "tips.title": "Merksätze",
        "tips.intro": "Halte dir diese Strategien vor Augen:",
        "tips.item1.left": "Lerne das Genus mit.",
        "tips.item1.right": "ein der Tisch → ein Tisch",
        "tips.item2.left": "Nutze Farben oder Symbole.",
        "tips.item2.right": "Blau = maskulin, Rot = feminin.",
        "tips.item3.left": "Sprich laut.",
        "tips.item3.right": "Bilde sofort einen Satz mit dem neuen Wort.",
        "tips.outro": "Im Plural verwendest du keine unbestimmten Artikel. Das lernst du in der nächsten Lektion.",
        "label.lesson": "Lesson",
        "label.practice": "Practice",
        "label.grammar tip": "Grammar tip",
        "button.start": "Lektion starten",
        "button.next": "Weiter",
        "button.check": "Prüfen",
        "button.finish": "Fertig",
        "feedback.default": "",
        "feedback.selectAnswer": "Bitte wähle eine Antwort, bevor du prüfst.",
        "feedback.correctMultipleChoice": "✅ Sehr gut!",
        "feedback.correctDragDrop": "✅ Gut gemacht!",
        "feedback.incorrect": "❌ Nicht richtig!",
        "feedback.correctAnswerLabel": "Korrekte Antwort:",
      },
      en: {
        "page.title": "Indefinite articles in the singular",
        "intro.title": "Indefinite articles in the singular",
        "intro.subtitle": "ein or eine?",
        "intro.description": "Learn how to use ein and eine to describe people, things, and places for the first time.",
        "intro.level": "Beginner · A1",
        "intro.duration": "10 minutes",
        "rule.title": "Basic rule",
        "rule.subtitle": "Match the noun's gender",
        "rule.description": "The indefinite article follows the grammatical gender:",
        "rule.item1.left": "Masculine",
        "rule.item1.right": "ein Mann · ein Stuhl",
        "rule.item2.left": "Feminine",
        "rule.item2.right": "eine Frau · eine Lampe",
        "rule.item3.left": "Neuter",
        "rule.item3.right": "ein Kind · ein Haus",
        "usage.title": "When do you use them?",
        "usage.subtitle": "Common situations",
        "usage.item1.left": "New information",
        "usage.item1.right": "Das ist ein Zimmer.",
        "usage.item2.left": "Jobs",
        "usage.item2.right": "Sie ist eine Ärztin.",
        "usage.item3.left": "Counting",
        "usage.item3.right": "Ich habe ein Ticket.",
        "examples.title": "Examples in context",
        "examples.subtitle": "Remember full sentences",
        "examples.item1.left": "Das ist ein Lehrer aus Berlin.",
        "examples.item2.left": "Ich suche eine Wohnung in der Stadt.",
        "examples.item3.left": "Wir planen ein Fest für Freunde.",
        "practice.q1.prompt": "Das ist ___ Tisch.",
        "practice.q1.option1": "ein",
        "practice.q1.option2": "eine",
        "practice.q1.option3": "einen",
        "practice.q2.prompt": "Sie kauft ___ Blume.",
        "practice.q2.option1": "ein",
        "practice.q2.option2": "eine",
        "practice.q2.option3": "einer",
        "practice.drag1.prompt": "Arrange the words into a sentence.",
        "practice.drag1.word1": "Apfel",
        "practice.drag1.word2": "ist",
        "practice.drag1.word3": "Das",
        "practice.drag1.word4": "ein",
        "practice.q4.prompt": "Wir brauchen ___ Idee.",
        "practice.q4.option1": "eine",
        "practice.q4.option2": "ein",
        "practice.q4.option3": "einem",
        "practice.q5.prompt": "Er schreibt ___ Brief.",
        "practice.q5.option1": "eine",
        "practice.q5.option2": "einen",
        "practice.q5.option3": "ein",
        "practice.q6.prompt": "Ich brauche ___ Glas Wasser.",
        "practice.q6.option1": "ein",
        "practice.q6.option2": "eine",
        "practice.q6.option3": "einem",
        "practice.q7.prompt": "Hast du ___ Frage?",
        "practice.q7.option1": "ein",
        "practice.q7.option2": "eine",
        "practice.q7.option3": "einen",
        "practice.drag2.prompt": "Build the sentence.",
        "practice.drag2.word1": "ein",
        "practice.drag2.word2": "haben",
        "practice.drag2.word3": "Problem",
        "practice.drag2.word4": "Wir",
        "practice.q9.prompt": "Das Kind malt ___ Bild.",
        "practice.q9.option1": "eine",
        "practice.q9.option2": "ein",
        "practice.q9.option3": "einem",
        "practice.q10.prompt": "Ich treffe ___ Freundin im Café.",
        "practice.q10.option1": "ein",
        "practice.q10.option2": "eine",
        "practice.q10.option3": "einer",
        "tips.title": "Memory tips",
        "tips.intro": "Keep these strategies in mind:",
        "tips.item1.left": "Learn the gender with the noun.",
        "tips.item1.right": "der Tisch → ein Tisch",
        "tips.item2.left": "Use colors or symbols.",
        "tips.item2.right": "Blue = masculine, red = feminine.",
        "tips.item3.left": "Say it out loud.",
        "tips.item3.right": "Immediately form a sentence with the new word.",
        "tips.outro": "In the plural you don't use indefinite articles. You'll learn that next.",
        "label.lesson": "Lesson",
        "label.practice": "Practice",
        "label.grammar tip": "Grammar tip",
        "button.start": "Start lesson",
        "button.next": "Next",
        "button.check": "Check",
        "button.finish": "Finish",
        "feedback.default": "",
        "feedback.selectAnswer": "Please choose an answer before checking.",
        "feedback.correctMultipleChoice": "✅ Great job!",
        "feedback.correctDragDrop": "✅ Well done!",
        "feedback.incorrect": "❌ Not quite!",
        "feedback.correctAnswerLabel": "Correct answer:",
      },
    },
  };

  const params = new URLSearchParams(window.location.search);
  const requested = (params.get("ln") || params.get("lang") || data.fallbackLanguage || "de").toLowerCase();
  const language = data.translations[requested]
    ? requested
    : data.translations[data.fallbackLanguage]
      ? data.fallbackLanguage
      : Object.keys(data.translations)[0];
  const dir = data.languages[language]?.dir || "ltr";
  const dictionary = data.translations[language] || {};
  const translator = (key, fallback = "") => dictionary[key] || fallback;
  window.lessonLocalization = {
    language,
    dir,
    translate: translator,
    availableLanguages: Object.keys(data.translations),
  };
  document.documentElement.lang = language;
  document.documentElement.dir = dir;
  if (document.body) {
    document.body.dir = dir;
  }
  const pageTitle = translator("page.title");
  if (pageTitle) {
    document.title = pageTitle;
  }
  document.querySelectorAll("[data-i18n]").forEach((node) => {
    const key = node.getAttribute("data-i18n");
    if (!key) return;
    const value = translator(key, node.textContent);
    if (typeof value === "string") {
      node.textContent = value;
    }
  });
})();
