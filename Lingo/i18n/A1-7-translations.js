(() => {
  const data = {
    fallbackLanguage: "de",
    languages: {
      de: { label: "Deutsch", dir: "ltr" },
      en: { label: "English", dir: "ltr" },
      ru: { label: "Русский", dir: "ltr" },
      uk: { label: "Українська", dir: "ltr" },
      es: { label: "Español", dir: "ltr" },
      fr: { label: "Français", dir: "ltr" },
      ar: { label: "العربية", dir: "rtl" },
      tr: { label: "Türkçe", dir: "ltr" },
      it: { label: "Italiano", dir: "ltr" },
      ro: { label: "Română", dir: "ltr" },
      sv: { label: "Svenska", dir: "ltr" },
      pt: { label: "Português", dir: "ltr" },
      ko: { label: "한국어", dir: "ltr" },
      ja: { label: "日本語", dir: "ltr" },
      nl: { label: "Nederlands", dir: "ltr" },
      zh: { label: "中文", dir: "ltr" },
      hr: { label: "Hrvatski", dir: "ltr" },
      hy: { label: "Հայերեն", dir: "ltr" },
    },
    translations: {
      de: {
        "page.title": "Reflexivpronomen im Alltag",
        "intro.title": "Reflexivpronomen im Alltag",
        "intro.subtitle": "Sicher im Alltag sprechen",
        "intro.description":
          "Entdecke, wie du die Reflexivpronomen mich, dich, sich, uns und euch sicher in alltäglichen Sätzen verwendest.",
        "intro.level": "Anfänger · A1",
        "intro.duration": "12 Minuten",
        "forms.title": "Die Formen im Überblick",
        "forms.subtitle": "Akkusativpronomen zu jeder Person",
        "forms.description": "Merke dir die Reflexivpronomen im Akkusativ:",
        "forms.item1.left": "ich → mich",
        "forms.item1.right": "z. B. Ich wasche mich.",
        "forms.item2.left": "du → dich",
        "forms.item2.right": "z. B. Du beeilst dich.",
        "forms.item3.left": "er/sie/es → sich",
        "forms.item3.right": "z. B. Er rasiert sich.",
        "forms.item4.left": "wir → uns",
        "forms.item4.right": "z. B. Wir treffen uns.",
        "forms.item5.left": "ihr → euch",
        "forms.item5.right": "z. B. Ihr setzt euch.",
        "forms.item6.left": "sie/Sie → sich",
        "forms.item6.right": "z. B. Sie entschuldigen sich.",
        "verbs.title": "Typische reflexive Verben",
        "verbs.subtitle": "Diese Verben benutzt du regelmäßig mit einem Reflexivpronomen:",
        "verbs.item1.left": "sich anziehen",
        "verbs.item1.right": "Ich ziehe mich schnell an.",
        "verbs.item2.left": "sich konzentrieren",
        "verbs.item2.right": "Du konzentrierst dich gut.",
        "verbs.item3.left": "sich erinnern",
        "verbs.item3.right": "Sie erinnert sich an den Termin.",
        "verbs.item4.left": "sich freuen",
        "verbs.item4.right": "Wir freuen uns auf das Wochenende.",
        "verbs.item5.left": "sich setzen",
        "verbs.item5.right": "Setzt euch doch!",
        "structure.title": "Satzmuster merken",
        "structure.description":
          "Das Reflexivpronomen steht direkt nach dem konjugierten Verb oder nach dem Subjekt in Aussagesätzen.",
        "structure.item1.left": "Ich entspanne mich.",
        "structure.item1.right": "Subjekt + Verb + Pronomen.",
        "structure.item2.left": "Beeilst du dich?",
        "structure.item2.right": "Verb + Subjekt + Pronomen in Fragen.",
        "structure.item3.left": "..., weil wir uns treffen.",
        "structure.item3.right": "Im Nebensatz steht es am Ende.",
        "structure.outro": "Achte darauf, dass Subjekt und Pronomen zusammenpassen.",
        "practice.q1.prompt": "Ich wasche ___ jeden Morgen.",
        "practice.q1.hint": "Wähle das passende Pronomen.",
        "practice.q1.option1": "mich",
        "practice.q1.option2": "dich",
        "practice.q1.option3": "uns",
        "practice.q2.prompt": "Beeilst du ___ vor der Arbeit?",
        "practice.q2.hint": "Denke an die Form für „du“.",
        "practice.q2.option1": "mich",
        "practice.q2.option2": "dich",
        "practice.q2.option3": "euch",
        "practice.q3.prompt": "Lisa erinnert ___ an den Termin.",
        "practice.q3.hint": "Achte auf die 3. Person Singular.",
        "practice.q3.option1": "dich",
        "practice.q3.option2": "sich",
        "practice.q3.option3": "uns",
        "practice.q4.prompt": "Wir treffen ___ nach der Arbeit.",
        "practice.q4.hint": "Das Subjekt ist „wir“.",
        "practice.q4.option1": "euch",
        "practice.q4.option2": "uns",
        "practice.q4.option3": "sich",
        "practice.q5.prompt": "Setzt ihr ___ bitte auf die Stühle?",
        "practice.q5.hint": "Das Pronomen gehört zu „ihr“.",
        "practice.q5.option1": "uns",
        "practice.q5.option2": "euch",
        "practice.q5.option3": "mich",
        "practice.q6.prompt": "Die Kinder freuen ___ auf den Ausflug.",
        "practice.q6.hint": "Überlege, welche Form zu „sie“ passt.",
        "practice.q6.option1": "euch",
        "practice.q6.option2": "uns",
        "practice.q6.option3": "sich",
        "practice.q7.prompt": "Frau Keller erkundigt ___ nach dem Weg.",
        "practice.q7.hint": "Singular, höfliche Form.",
        "practice.q7.option1": "sich",
        "practice.q7.option2": "dich",
        "practice.q7.option3": "uns",
        "practice.drag1.prompt": "Ordne den Satz richtig.",
        "practice.drag1.hint": "Ziel: Vorfreude auf das Wochenende.",
        "practice.drag1.word1": "Wir",
        "practice.drag1.word2": "freuen",
        "practice.drag1.word3": "uns",
        "practice.drag1.word4": "auf",
        "practice.drag1.word5": "das",
        "practice.drag1.word6": "Wochenende",
        "practice.drag2.prompt": "Bilde den passenden Satz.",
        "practice.drag2.hint": "Hinweis: Du hast wenig Zeit.",
        "practice.drag2.word1": "Ich",
        "practice.drag2.word2": "mich",
        "practice.drag2.word3": "muss",
        "practice.drag2.word4": "beeilen",
        "practice.q10.prompt": "Nach dem Yoga entspanne ich ___ auf dem Sofa.",
        "practice.q10.hint": "Das Subjekt ist „ich“.",
        "practice.q10.option1": "mich",
        "practice.q10.option2": "dich",
        "practice.q10.option3": "sich",
        "practice.q11.prompt": "Freut ihr ___ auf das Konzert?",
        "practice.q11.hint": "Denk an die passende Pluralform.",
        "practice.q11.option1": "uns",
        "practice.q11.option2": "euch",
        "practice.q11.option3": "sich",
        "practice.q12.prompt": "Die Kollegen beschweren ___ über den Lärm.",
        "practice.q12.hint": "Plural, dritte Person.",
        "practice.q12.option1": "sich",
        "practice.q12.option2": "mich",
        "practice.q12.option3": "euch",
        "summary.title": "Zusammenfassung",
        "summary.description":
          "Du kannst Reflexivpronomen sicher zuordnen, wenn du zuerst das Subjekt bestimmst. Wiederhole die Formen regelmäßig und bilde eigene Sätze aus deinem Alltag.",
        "summary.item1.left": "ich / du / er sie es",
        "summary.item1.right": "→ mich / dich / sich",
        "summary.item2.left": "wir / ihr / sie",
        "summary.item2.right": "→ uns / euch / sich",
        "summary.item3.left": "Immer nach dem Verb",
        "summary.item3.right": "Beispiel: Wir beeilen uns.",
        "summary.outro": "Super gemacht! Wiederhole die Übungen, bis sie leicht fallen.",
        "label.lesson": "Lektion",
        "label.practice": "Übung",
        "label.grammar tip": "Grammatik-Tipp",
        "button.start": "Lektion starten",
        "button.next": "Weiter",
        "button.check": "Prüfen",
        "button.finish": "Fertig",
        "feedback.default": "",
        "feedback.selectAnswer": "Bitte wähle eine Antwort, bevor du prüfst.",
        "feedback.correctMultipleChoice": "✅ Sehr gut!",
        "feedback.correctDragDrop": "✅ Gut gemacht!",
        "feedback.incorrect": "❌ Nicht richtig!",
        "feedback.correctAnswerLabel": "Korrekte Antwort:",
      },
      en: {
        "page.title": "Reflexive pronouns in daily life",
        "intro.title": "Reflexive pronouns in daily life",
        "intro.subtitle": "Confident in everyday conversations",
        "intro.description":
          "Discover how to use the reflexive pronouns mich, dich, sich, uns, and euch naturally in daily sentences.",
        "intro.level": "Beginner · A1",
        "intro.duration": "12 minutes",
        "forms.title": "Overview of the forms",
        "forms.subtitle": "Accusative pronouns for every person",
        "forms.description": "Memorize the reflexive pronouns in the accusative:",
        "forms.item1.left": "ich → mich",
        "forms.item1.right": "e.g. Ich wasche mich.",
        "forms.item2.left": "du → dich",
        "forms.item2.right": "e.g. Du beeilst dich.",
        "forms.item3.left": "er/sie/es → sich",
        "forms.item3.right": "e.g. Er rasiert sich.",
        "forms.item4.left": "wir → uns",
        "forms.item4.right": "e.g. Wir treffen uns.",
        "forms.item5.left": "ihr → euch",
        "forms.item5.right": "e.g. Ihr setzt euch.",
        "forms.item6.left": "sie/Sie → sich",
        "forms.item6.right": "e.g. Sie entschuldigen sich.",
        "verbs.title": "Typical reflexive verbs",
        "verbs.subtitle": "You use these verbs regularly with a reflexive pronoun:",
        "verbs.item1.left": "sich anziehen",
        "verbs.item1.right": "Ich ziehe mich schnell an.",
        "verbs.item2.left": "sich konzentrieren",
        "verbs.item2.right": "Du konzentrierst dich gut.",
        "verbs.item3.left": "sich erinnern",
        "verbs.item3.right": "Sie erinnert sich an den Termin.",
        "verbs.item4.left": "sich freuen",
        "verbs.item4.right": "Wir freuen uns auf das Wochenende.",
        "verbs.item5.left": "sich setzen",
        "verbs.item5.right": "Setzt euch doch!",
        "structure.title": "Remember the sentence pattern",
        "structure.description":
          "Place the reflexive pronoun right after the conjugated verb or directly after the subject in statements.",
        "structure.item1.left": "Ich entspanne mich.",
        "structure.item1.right": "Subject + verb + pronoun.",
        "structure.item2.left": "Beeilst du dich?",
        "structure.item2.right": "Verb + subject + pronoun in questions.",
        "structure.item3.left": "..., weil wir uns treffen.",
        "structure.item3.right": "In subordinate clauses it moves to the end.",
        "structure.outro": "Make sure the subject and pronoun agree.",
        "practice.q1.prompt": "Ich wasche ___ jeden Morgen.",
        "practice.q1.hint": "Choose the matching pronoun.",
        "practice.q1.option1": "mich",
        "practice.q1.option2": "dich",
        "practice.q1.option3": "uns",
        "practice.q2.prompt": "Beeilst du ___ vor der Arbeit?",
        "practice.q2.hint": "Think about the form for \"du\".",
        "practice.q2.option1": "mich",
        "practice.q2.option2": "dich",
        "practice.q2.option3": "euch",
        "practice.q3.prompt": "Lisa erinnert ___ an den Termin.",
        "practice.q3.hint": "Focus on the 3rd person singular.",
        "practice.q3.option1": "dich",
        "practice.q3.option2": "sich",
        "practice.q3.option3": "uns",
        "practice.q4.prompt": "Wir treffen ___ nach der Arbeit.",
        "practice.q4.hint": "The subject is \"wir\".",
        "practice.q4.option1": "euch",
        "practice.q4.option2": "uns",
        "practice.q4.option3": "sich",
        "practice.q5.prompt": "Setzt ihr ___ bitte auf die Stühle?",
        "practice.q5.hint": "Match the pronoun to \"ihr\".",
        "practice.q5.option1": "uns",
        "practice.q5.option2": "euch",
        "practice.q5.option3": "mich",
        "practice.q6.prompt": "Die Kinder freuen ___ auf den Ausflug.",
        "practice.q6.hint": "Which form fits \"sie\" (they)?",
        "practice.q6.option1": "euch",
        "practice.q6.option2": "uns",
        "practice.q6.option3": "sich",
        "practice.q7.prompt": "Frau Keller erkundigt ___ nach dem Weg.",
        "practice.q7.hint": "Singular, polite form.",
        "practice.q7.option1": "sich",
        "practice.q7.option2": "dich",
        "practice.q7.option3": "uns",
        "practice.drag1.prompt": "Put the sentence in order.",
        "practice.drag1.hint": "Goal: express excitement about the weekend.",
        "practice.drag1.word1": "Wir",
        "practice.drag1.word2": "freuen",
        "practice.drag1.word3": "uns",
        "practice.drag1.word4": "auf",
        "practice.drag1.word5": "das",
        "practice.drag1.word6": "Wochenende",
        "practice.drag2.prompt": "Build the matching sentence.",
        "practice.drag2.hint": "Hint: you're short on time.",
        "practice.drag2.word1": "Ich",
        "practice.drag2.word2": "mich",
        "practice.drag2.word3": "muss",
        "practice.drag2.word4": "beeilen",
        "practice.q10.prompt": "Nach dem Yoga entspanne ich ___ auf dem Sofa.",
        "practice.q10.hint": "The subject is \"ich\".",
        "practice.q10.option1": "mich",
        "practice.q10.option2": "dich",
        "practice.q10.option3": "sich",
        "practice.q11.prompt": "Freut ihr ___ auf das Konzert?",
        "practice.q11.hint": "Remember the correct plural form.",
        "practice.q11.option1": "uns",
        "practice.q11.option2": "euch",
        "practice.q11.option3": "sich",
        "practice.q12.prompt": "Die Kollegen beschweren ___ über den Lärm.",
        "practice.q12.hint": "Plural, third person.",
        "practice.q12.option1": "sich",
        "practice.q12.option2": "mich",
        "practice.q12.option3": "euch",
        "summary.title": "Summary",
        "summary.description":
          "You can match reflexive pronouns reliably when you identify the subject first. Review the forms regularly and build your own everyday sentences.",
        "summary.item1.left": "ich / du / er sie es",
        "summary.item1.right": "→ mich / dich / sich",
        "summary.item2.left": "wir / ihr / sie",
        "summary.item2.right": "→ uns / euch / sich",
        "summary.item3.left": "Always after the verb",
        "summary.item3.right": "Example: Wir beeilen uns.",
        "summary.outro": "Great job! Repeat the exercises until they feel easy.",
        "label.lesson": "Lesson",
        "label.practice": "Practice",
        "label.grammar tip": "Grammar tip",
        "button.start": "Start lesson",
        "button.next": "Next",
        "button.check": "Check",
        "button.finish": "Finish",
        "feedback.default": "",
        "feedback.selectAnswer": "Please choose an answer before checking.",
        "feedback.correctMultipleChoice": "✅ Great job!",
        "feedback.correctDragDrop": "✅ Well done!",
        "feedback.incorrect": "❌ Not quite right!",
        "feedback.correctAnswerLabel": "Correct answer:",
      },
    },
  };

  [
    "ru",
    "uk",
    "es",
    "fr",
    "ar",
    "tr",
    "it",
    "ro",
    "sv",
    "pt",
    "ko",
    "ja",
    "nl",
    "zh",
    "hr",
    "hy",
  ].forEach((code) => {
    if (!data.translations[code]) {
      data.translations[code] = data.translations.en;
    }
  });

  const params = new URLSearchParams(window.location.search);
  const requested = (params.get("ln") || params.get("lang") || data.fallbackLanguage || "de").toLowerCase();
  const language = data.translations[requested]
    ? requested
    : data.translations[data.fallbackLanguage]
      ? data.fallbackLanguage
      : Object.keys(data.translations)[0];
  const dir = data.languages[language]?.dir || "ltr";
  const dictionary = data.translations[language] || {};
  const translator = (key, fallback = "") => dictionary[key] || fallback;
  window.lessonLocalization = {
    language,
    dir,
    translate: translator,
    availableLanguages: Object.keys(data.translations),
  };
  document.documentElement.lang = language;
  document.documentElement.dir = dir;
  if (document.body) {
    document.body.dir = dir;
  }
  const pageTitle = translator("page.title");
  if (pageTitle) {
    document.title = pageTitle;
  }
  document.querySelectorAll("[data-i18n]").forEach((node) => {
    const key = node.getAttribute("data-i18n");
    if (!key) return;
    const value = translator(key, node.textContent);
    if (typeof value === "string") {
      node.textContent = value;
    }
  });
})();
